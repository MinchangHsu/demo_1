<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>layui</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="layui/css/layui.css" media="all">
    <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
    <script src="js/jquery.min.js"></script>
    <script src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
    <script src="layui/layui.js"></script>
</head>

<body class="layui-layout-body">
    <div class="layui-layout layui-layout-admin">
        <div class="layui-header">
            <div class="layui-logo">Junze - Business </div>
            <!-- 头部区域（可配合layui已有的水平导航） -->
            <ul class="layui-nav layui-layout-left">
                <li class="layui-nav-item"><a href="">控制台</a></li>
                <li class="layui-nav-item"><a href="">客戶</a></li>
                <li class="layui-nav-item">
                    <a href="javascript:;">其它系统</a>
                    <dl class="layui-nav-child">
                        <dd><a href="">邮件管理</a></dd>
                        <dd><a href="">消息管理</a></dd>
                        <dd><a href="">授权管理</a></dd>
                    </dl>
                </li>
            </ul>
            <ul class="layui-nav layui-layout-right">
                <li class="layui-nav-item">
                    <a href="javascript:;">
                        <img src="images/test.jpg" class="layui-nav-img">
                    maggie
                    </a>
                    <dl class="layui-nav-child">
                        <dd><a href="">基本资料</a></dd>
                        <dd><a href="">安全设置</a></dd>
                    </dl>
                </li>
                <li class="layui-nav-item"><a href="">登出</a></li>
            </ul>
        </div>
        <div class="layui-side layui-bg-black">
            <div class="layui-side-scroll">
                <!-- 左侧导航区域（可配合layui已有的垂直导航） -->
                <ul class="layui-nav layui-nav-tree" lay-filter="test">
                    <li class="layui-nav-item layui-nav-itemed">
                        <a class="" href="javascript:;">訂單管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;">新增訂單</a></dd>
                            <dd><a href="javascript:;">查詢訂單</a></dd>
                        </dl>
                    </li>
                    <li class="layui-nav-item">
                        <a href="javascript:;">商品管理</a>
                        <dl class="layui-nav-child">
                            <dd><a href="javascript:;">新增商品</a></dd>
                            <dd><a href="javascript:;">查詢商品</a></dd>
                        </dl>
                    </li>
                </ul>
            </div>
        </div>
        <div class="layui-body">
            <div class="layui-tab-item layui-show" style="margin: 30px 10px; margin-left: 30px;">
                <span class="layui-breadcrumb">
                    <a href="/">首页</a>
                    <a><cite>訂單管理</cite></a>
                    <a><cite>查詢訂單</cite></a>
                </span>
            </div>
            <!-- 搜尋區域 -->
            <form class="layui-form" action="">
                <div class="layui-form-item" id="searchForm">
                    <div class="layui-inline">
                        <label class="layui-form-label" style="padding-right:0px;" >訂單編號：</label>
                        <div class="layui-input-inline">
                            <input type="text" name="orderNumber" id="orderNumber" lay-verify="required|number" autocomplete="off" class="layui-input" value="123456">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label" style="padding-right:0px;" >廠商編號：</label>
                        <div class="layui-input-inline">
                            <input type="text" name="customerNumber" id="customerNumber" lay-verify="customerNumber" autocomplete="off" class="layui-input" value="asd1234">
                        </div>
                    </div>
                    <div class="layui-inline">
                        <label class="layui-form-label" style="width:125px;padding-right:0px;" >訂單日期(起 - 迄)：</label>
                        <div class="layui-input-inline">
                            <input type="text" name="orderDate" id="orderDateRang"  placeholder="yyyy-MM-dd" autocomplete="off" class="layui-input">
                        </div>
                    </div>
                </div>
                <div class="layui-input-block" style="margin-top: 5px;">
                    <input type="button" class="layui-btn" lay-submit="" id="searchBtn" value="查詢">
                    <button type="reset" class="layui-btn layui-btn-primary" id="reset" >清除</button>
                </div>
            </form>
            <!-- 結果區域 -->
            <div style="padding: 5px;">
                <table class="layui-hide" id="order" lay-filter="demo"></table>
                <script type="text/html" id="editorBtn">
                    <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
                    <a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
                    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
                </script>
            </div>
        </div>
        <div class="layui-footer">
            <!-- 底部固定区域 -->
            © Junze.com - 0800-123123
        </div>
    </div>

    <script>
    
    $(function(){
        console.log('javaScript Start !!');
        
        //監聽事件
        $('#reset').bind('click',resetSearchData);
        
    });

    var resetSearchData = function(){
        console.log('reset searchForm !!');
        $('#searchForm input').val('');
    };
    
    //畫面配置檢核
    layui.use(['form','layedit', 'laydate' , 'table'], function() {
        var form = layui.form ,
            layer = layui.layer ,
            table = layui.table ,
            laydate = layui.laydate;

        //日期
        laydate.render({
            elem: '#orderDateRang',
            range: '~',
            format: 'yyyy/MM/dd'
        });
        
        
        //自定义验证规则
        form.verify({
            title: function(value) {
                if (value.length < 5) {
                    return '标题至少得5个字符啊';
                }
            },
            pass: [/(.+){6,12}$/, '密码必须6到12位'],
            content: function(value) {
                layedit.sync(editIndex);
            },
            customerNumber:[/([a-zA-Z]){3}([0-9]){4}$/,'廠商編號格式錯誤 EX.abc1234']
        });
        
        //監聽submit  表單驗證完，才會走到這
        form.on('submit()', function(data){
        	console.log('123456');
            bulidTable();
        });
        
        
        //監聽操作工具
        table.on('tool(demo)', function(obj){ //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
          var data = obj.data //获得当前行数据
          ,layEvent = obj.event; //获得 lay-event 对应的值
          
          if(layEvent === 'detail'){
            layer.msg('查看操作');
          } else if(layEvent === 'del'){
            layer.confirm('真的删除行么', function(index){
              obj.del(); //删除对应行（tr）的DOM结构
              layer.close(index);
              //向服务端发送删除指令
            });
          } else if(layEvent === 'edit'){
            layer.msg('编辑操作');
          }
        });
        
    });
        
    var bulidTable = function(){
    	
        console.log('ID:test123');
        
        var paramStr = '{';
        $('#searchForm input').each(function(i){
        	var searchParaCount = $('#searchForm input').size() - 1;
            if($(this).val() != ''){
            	if(i != 0){
            		paramStr += ',';
            	}
	        	paramStr += '"' + $(this).attr('name') + '":"' + $(this).val() + '"' ;
            }
            
        	if(i == searchParaCount){
        		paramStr += '}';
        	}

        });
        
        console.log('paramStr:'+paramStr);
        
        layui.use('table', function() {
            var table = layui.table;
            
            obj = JSON.parse(paramStr);
            
            //產生表單
            table.render({
                elem: '#order', // 對應哪個table 的 id
                height: 600, // 表格高度  full - 20  全屏 - 差值
                url: '/userLoginController/test', //数据接口
                method: "POST",
                where: obj,
                page: true, //开启分页
                cols: [
                    [ //表头
                        { field: 'id', title: '訂單號', width: 150, sort: true, fixed: 'left' },
                        { field: 'username', title: '客戶編號', width: 100 },
                        { field: 'sex', title: '收件人', width: 100, sort: true },
                        { field: 'city', title: '地址', width: 300 },
                        { field: 'sign', title: '電話', width: 150 },
                        { field: 'experience', title: '訂單日期', width: 110, sort: true },
                        { field: 'score', title: '訂單金額', width: 110, sort: true },
                        { field: 'classify', title: '出貨日期', width: 110 },
                        { field: 'wealth', title: '訂單狀態', width: 110, sort: true },
                        { fixed: 'right', width: 165, align:'center', toolbar: '#editorBtn'}
                    ]
                ],
                limit: 50,
                limits: [10, 30, 50, 100, 300],
                loading: true,
            });
    
        });
    };
    </script>
</body>

</html>